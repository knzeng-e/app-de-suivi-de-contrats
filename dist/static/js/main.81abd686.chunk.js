(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{272:function(e,t,a){e.exports=a(542)},277:function(e,t,a){},542:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(268),l=a.n(c),i=(a(277),a(19)),o=a(20),s=a(22),u=a(21),m=a(23),d=a(545),h=a(547),p=a(543),E=a(284),f=a(544),g=a(8),b=Object(g.b)(function(e){return{initials:e.firebase.profile.initals}},function(e){return{signOut:function(){return e(function(e,t,a){(0,a.getFirebase)().auth().signOut().then(function(){e({type:"SIGNOUT_SUCCESS"})})})}}})(function(e){var t=e.initials;return console.log("state to props ==> ",t),r.a.createElement("ul",{className:"right"},r.a.createElement("li",null,r.a.createElement(f.a,{to:"/create"},"Nouveau contrat")),r.a.createElement("li",null,r.a.createElement("a",{onClick:e.signOut},"D\xe9connexion")),r.a.createElement("li",null,r.a.createElement(f.a,{to:"/",className:"btn btn-floating green lighten-2"},t)))}),v=function(){return r.a.createElement("ul",{className:"right"},r.a.createElement("li",null,r.a.createElement(f.a,{to:"/signup"},"S'enregistrer")),r.a.createElement("li",null,r.a.createElement(f.a,{to:"/signin"},"Connexion")))},N=Object(g.b)(function(e){return console.log("Print State ====> ",e),{auth:e.firebase.auth}})(function(e){var t=e.auth.uid?r.a.createElement(b,null):r.a.createElement(v,null);return r.a.createElement("nav",{className:"nav-wrapper indigo darken-4 z-depth-4"},r.a.createElement("div",{className:"container"},r.a.createElement(E.a,{to:"/",className:"left brand-logo"},"Contrats Papel"),t))}),O=function(e){var t,a=e.contract,n=e.contract_id,c=a.validity;return r.a.createElement("ul",{className:"collapsible contract_list"},r.a.createElement("li",null,r.a.createElement(E.a,{to:"/contract/"+n},r.a.createElement("div",{className:"contract_list collapsible-header hoverable"},r.a.createElement("i",{className:"material-icons"},"layers"),a.title,r.a.createElement("span",{className:(t=c,"green"===a.colorStatus?"new badge green darken-2 z-depth-4":"orange"===a.colorStatus?"new badge orange darken-1 z-depth-4":"red"===a.colorStatus?"new badge red darken-4 z-depth-4":"black"===a.colorStatus?(t="contrat expir\xe9","new badge black z-depth-4"):void 0),"data-badge-caption":t}))),r.a.createElement("div",{className:"collapsible-body"})))},C=function(e){var t=e.contracts;return t&&0!==t.length?(console.log("contracts ==> ",t.length),r.a.createElement("div",{className:"contract-list section"},t&&t.map(function(e){return r.a.createElement(O,{contract:e,contract_id:e.id,key:e.id})}))):(console.log("VIDE!!!!!"),r.a.createElement("div",{className:"section"},r.a.createElement("blockquote",null,"Vous n'avez pas de contrats ...")))},y=a(31),S=a(24),j=a(546),R=function(e){function t(){return Object(i.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this.props,t=e.contracts;return e.auth.uid?r.a.createElement("div",{className:" dashboard container"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col s12 m6"},r.a.createElement(C,{contracts:t})))):r.a.createElement(j.a,{to:"/signin"})}}]),t}(n.Component),w=Object(S.d)(Object(g.b)(function(e){return console.log(e),{contracts:e.firestore.ordered.contracts,auth:e.firebase.auth}}),Object(y.firestoreConnect)([{collection:"contracts"}]))(R),D=a(32),x=function(e,t){console.log("PROPS ====> ",t);var a=window.confirm('Voulez-vous supprimer le contract "'+t.contract.title+'" ?');return function(n,r,c){c.getFirebase;var l=(0,c.getFirestore)();a&&l.collection("contracts").doc(e).delete().then(function(){console.log("CONTRAT SUPPRIME"),n({type:"DELETE_CONTRACT",contract:e}),function(e){e.history.push("/"),console.log("PROPS ====> ",e)}(t)}).catch(function(e){n({type:"DELETE_CONTRACT_ERROR",err:e})})}},T=function(e,t){return console.log("A MODIFIER ==> ",e),function(a,n,r){r.getFirebase;var c=(0,r.getFirestore)().collection("contracts").doc(e);t.contract.content;console.log("\nContrat \xe0 modifier ==> ",c),console.log("STATE_To_PROPS ==> ",t),t.history.push("/modify/"+e),c.update({}).then(function(n){console.log("CONTRAT Modifi\xe9 ==> ",n),a({type:"MODIFY_CONTRACT",contract:e,state:t})})}},F=a(5),A=a.n(F);var _=Object(S.d)(Object(g.b)(function(e,t){var a=t.match.params.id,n=e.firestore.data.contracts;return{contract:n?n[a]:null,auth:e.firebase.auth,id:a}},function(e){return{deleteContract:function(t,a){return e(x(t,a))},modifyContract:function(t,a){return e(T(t,a))}}}),Object(y.firestoreConnect)([{collection:"contracts"}]))(function(e){var t=e.contract,a=e.auth,n=e.deleteContract,c=(e.modifyContract,e.id);return t?a.uid?r.a.createElement("div",{className:"row container"},r.a.createElement("div",{className:"col s12"},r.a.createElement("div",{className:"card darken-1"},r.a.createElement("div",{className:"card-content  darken-4 z-depth-4"},r.a.createElement("span",{className:"card-title grey darken-3 white-text center-align z-depth-2"},t.title),r.a.createElement("br",null),r.a.createElement("blockquote",null,t.content)),r.a.createElement("div",{className:"card-action grey lighten-4 grey-text z-depth-4 center"},r.a.createElement("div",null,"Fin de validit\xe9 : ",t.validity),r.a.createElement("span",null,r.a.createElement("button",{className:"btn right red lighten-1",onClick:function(){return n(c,e)}},r.a.createElement("i",{className:"material-icons"},"delete"))),r.a.createElement("div",null,"Enregistr\xe9 par ",t.authorFistName," ",t.authorLastName),r.a.createElement("div",null,A()(t.createdAt.toDate()).calendar()))))):r.a.createElement(j.a,{to:"/signin"}):r.a.createElement("div",{className:"container center"},r.a.createElement("p",null,"Chargement du contrat..."))}),k=a(26),I=a(115),z=a.n(I),L=(a(248),function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).handleChange=function(e){a.setState(Object(k.a)({},e.target.id,e.target.value))},a.setColor=function(e,t,a){return A()().isSameOrAfter(e)?"black":A()().isBefore(t)?"green":A()().isBetween(t,a)?"orange":A()().isSameOrAfter(a)?"red":void 0},a.handleDate=function(e){console.log("DATE!!!! ===> ",A.a.locale());var t=A()(e),n=A()(e).subtract(6,"months"),r=A()(e).subtract(3,"months");console.log("FIRST REMIND ==> ",n.format("L")),console.log("SECOND_REMIND  ==> ",r.format("L")),a.setState({endDate:e,validity:t.format("L"),firstNotif:n.format("L"),secondNotif:r.format("L"),colorStatus:a.setColor(t,n,r)}),console.log("Dans 3 mois ==> ",r),console.log("Dans 6 mois ==> ",n)},a.handleSubmit=function(e){e.preventDefault(),a.props.modifyContract(a.state),a.props.history.push("/contract/"+a.props.id)},a}return Object(m.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this.props,t=e.auth,a=e.contract;e.id;return t.uid?r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"card col s12"},r.a.createElement("form",{onSubmit:this.handleSubmit,className:"card-content grey lighten-4 white z-depth-4"},r.a.createElement("h5",{className:"card-title grey darken-3 white-text center-align z-depth-2"},"Modification d'un contrat"),r.a.createElement("br",null),r.a.createElement("div",{className:"input-field grey-text z-depth-0 center"},r.a.createElement("label",{htmlFor:"title"},"Nom du contract"),r.a.createElement("input",{required:!0,type:"text",id:"title",value:this.props.content,onChange:this.handleChange})),r.a.createElement("div",{className:"input-field grey-text z-depth-0 center"},r.a.createElement("label",{htmlFor:"content"},"Descriptif du contrat"),r.a.createElement("textarea",{required:!0,className:"materialize-textarea",id:"content",value:a,onChange:this.handleChange})),r.a.createElement("div",null,r.a.createElement("br",null),r.a.createElement("div",null,r.a.createElement("span",{className:"input-field"},"Date de fin de validit\xe9 :",r.a.createElement(z.a,{required:!0,id:"validity",value:a,onChange:this.handleDate,minDate:new Date})),r.a.createElement("button",{className:"btn red lighten-1 z-depth-0 right"},"Modifier le contrat")))))):r.a.createElement(j.a,{to:"/signin"})}}]),t}(n.Component)),P=Object(g.b)(function(e,t){var a=t.match.params.id;return{auth:e.firebase.auth,id:a}},function(e){return{modifyContract:function(t){return e(T(t))}}})(L),U=function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={email:"",password:""},a.handleChange=function(e){a.setState(Object(k.a)({},e.target.id,e.target.value))},a.handleSubmit=function(e){e.preventDefault(),a.props.signIn(a.state)},a}return Object(m.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this.props,t=e.authError;return e.auth.uid?r.a.createElement(j.a,{to:"/"}):r.a.createElement("div",{className:"container form_style"},r.a.createElement("div",{className:"myDiv center white-text darken-4 z-depth-4"},"S'IDENTIFIER "),r.a.createElement("form",{onSubmit:this.handleSubmit,className:"white"},r.a.createElement("div",{className:"input-field"},r.a.createElement("i",{class:"material-icons prefix"},"mail_outline"),r.a.createElement("label",{htmlFor:"email"},"Email"),r.a.createElement("input",{type:"email",id:"email",onChange:this.handleChange})),r.a.createElement("div",{className:"input-field"},r.a.createElement("i",{class:"material-icons prefix"},"lock_outline"),r.a.createElement("label",{htmlFor:"password"},"Mot de passe"),r.a.createElement("input",{type:"password",id:"password",onChange:this.handleChange})),r.a.createElement("div",{className:"input-field center"},r.a.createElement("button",{className:"btn red lighten-1 z-depth-0"},"Connexion"),r.a.createElement("div",{className:"red-text center"},t?r.a.createElement("p",null,t):null))))}}]),t}(n.Component),G=Object(g.b)(function(e){return{authError:e.auth.authError,auth:e.firebase.auth}},function(e){return{signIn:function(t){return e((a=t,function(e,t,n){(0,n.getFirebase)().auth().signInWithEmailAndPassword(a.email,a.password).then(function(){e({type:"LOGIN_SUCCESS"})}).catch(function(t){e({type:"LOGIN_ERROR",err:t})})}));var a}}})(U),M=function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={email:"",password:"",firstName:"",lastName:""},a.handleChange=function(e){a.setState(Object(k.a)({},e.target.id,e.target.value))},a.handleSubmit=function(e){e.preventDefault(),a.props.signUp(a.state)},a}return Object(m.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this.props,t=e.auth,a=e.authError;return t.uid?r.a.createElement(j.a,{to:"/"}):r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"myDiv center white-text darken-4 z-depth-4"},"S'ENREGISTRER "),r.a.createElement("form",{onSubmit:this.handleSubmit,className:"white"},r.a.createElement("div",{className:"input-field"},r.a.createElement("i",{class:"material-icons prefix"},"contacts"),r.a.createElement("label",{htmlFor:"Pr\xe9nom"},"Nom"),r.a.createElement("input",{type:"text",id:"lastName",onChange:this.handleChange})),r.a.createElement("div",{className:"input-field"},r.a.createElement("i",{class:"material-icons prefix"},"assignment_ind"),r.a.createElement("label",{htmlFor:"Nom"},"Pr\xe9nom"),r.a.createElement("input",{type:"text",id:"firstName",onChange:this.handleChange})),r.a.createElement("div",{className:"input-field"},r.a.createElement("i",{class:"material-icons prefix"},"email"),r.a.createElement("label",{htmlFor:"email"},"Email"),r.a.createElement("input",{type:"email",id:"email",onChange:this.handleChange})),r.a.createElement("div",{className:"input-field"},r.a.createElement("i",{class:"material-icons prefix"},"locks"),r.a.createElement("label",{htmlFor:"password"},"Mot de passe"),r.a.createElement("input",{type:"password",id:"password",onChange:this.handleChange})),r.a.createElement("div",{className:"input-field center"},r.a.createElement("button",{className:"btn red lighten-1 z-depth-0"},"Valider"),r.a.createElement("div",{className:"red-text center"},a?r.a.createElement("p",null,a):null))))}}]),t}(n.Component),q=Object(g.b)(function(e){return{auth:e.firebase.auth,authError:e.auth.authError}},function(e){return{signUp:function(t){return e(function(e){return function(t,a,n){var r=n.getFirebase,c=(0,n.getFirestore)();r().auth().createUserWithEmailAndPassword(e.email,e.password).then(function(t){return c.collection("users").doc(t.user.uid).set({firstName:e.firstName,lastName:e.lastName,initals:e.firstName[0]+e.lastName[0]})}).then(function(){t({type:"SIGNUP_SUCCESS"})}).catch(function(e){t({type:"SIGNUP_ERROR",err:e})})}}(t))}}})(M),B=function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={title:"",content:"",creationDate:"",validity:"",endDate:"",firstNotif:"",secondNotif:"",colorStatus:""},a.handleChange=function(e){var t;a.setState((t={},Object(k.a)(t,e.target.id,e.target.value),Object(k.a)(t,"creationDate",Date()),t))},a.setColor=function(e,t,a){return A()().isSameOrAfter(e)?"black":A()().isBefore(t)?"green":A()().isBetween(t,a)?"orange":A()().isSameOrAfter(a)?"red":void 0},a.handleDate=function(e){var t=A()(e),n=A()(e).subtract(6,"months"),r=A()(e).subtract(3,"months");a.setState({endDate:e,validity:t.format("L"),firstNotif:n.format("L"),secondNotif:r.format("L"),colorStatus:a.setColor(t,n,r)})},a.handleSubmit=function(e){e.preventDefault(),a.props.createContract(a.state),a.props.history.push("/")},a}return Object(m.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return this.props.auth.uid?r.a.createElement("div",{className:"container form_style"},r.a.createElement("h5",{className:"myDiv  center white-text darken-4 z-depth-4"},"Enregistrement d'un contrat"),r.a.createElement("div",{className:""},r.a.createElement("form",{onSubmit:this.handleSubmit,className:"white"},r.a.createElement("br",null),r.a.createElement("div",{className:"input-field grey-text z-depth-0 center"},r.a.createElement("i",{class:"material-icons prefix"},"layers"),r.a.createElement("label",{htmlFor:"title"},"Nom du contract"),r.a.createElement("input",{required:!0,type:"text",id:"title",onChange:this.handleChange})),r.a.createElement("div",{className:"input-field grey-text z-depth-0 center"},r.a.createElement("i",{class:"material-icons prefix"},"event_note"),r.a.createElement("label",{htmlFor:"content"},"Descriptif du contrat"),r.a.createElement("textarea",{required:!0,className:"materialize-textarea",id:"content",onChange:this.handleChange})),r.a.createElement("div",null,r.a.createElement("br",null),r.a.createElement("div",null,r.a.createElement("span",{className:"input-field"},"Date de fin de validit\xe9 :",r.a.createElement(z.a,{className:"calendar",required:!0,id:"validity",onChange:this.handleDate,value:this.state.endDate,minDate:new Date})),r.a.createElement("button",{className:"btn red lighten-1 z-depth-0 right"},"Cr\xe9er le contrat")))))):r.a.createElement(j.a,{to:"/signin"})}}]),t}(n.Component),V=Object(g.b)(function(e){return{auth:e.firebase.auth}},function(e){return{createContract:function(t){return e(function(e){return function(t,a,n){n.getFirebase;var r=(0,n.getFirestore)(),c=a().firebase.profile,l=a().firebase.auth.uid;r.collection("contracts").add(Object(D.a)({},e,{authorFirstName:c.firstName,authorLastName:c.lastName,authorId:l,createdAt:new Date})).then(function(){t({type:"CREATE_CONTRACT",contract:e})}).catch(function(e){t({type:"CREATE_CONTRACT_ERROR",err:e})})}}(t))}}})(B),W=function(e){function t(){return Object(i.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return r.a.createElement(d.a,null,r.a.createElement("div",{className:"App"},r.a.createElement(N,null),r.a.createElement(h.a,null,r.a.createElement(p.a,{exact:!0,path:"/",component:w}),r.a.createElement(p.a,{path:"/contract/:id",component:_}),r.a.createElement(p.a,{path:"/signin",component:G}),r.a.createElement(p.a,{path:"/signup",component:q}),r.a.createElement(p.a,{path:"/create",component:V}),r.a.createElement(p.a,{path:"/modify/:id",component:P}))))}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var J={authError:null},Z=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:J,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOGIN_ERROR":return console.log("Login error"),Object(D.a)({},e,{authError:"Login failed"});case"LOGIN_SUCCESS":return console.log("Login Success"),Object(D.a)({},e,{authError:null});case"SIGNOUT_SUCCESS":return console.log("signout success"),e;case"SIGNUP_SUCCESS":return console.log("Signup success"),Object(D.a)({},e,{authError:null});case"SIGNUP_ERROR":return console.log("signup error"),Object(D.a)({},e,{authError:t.err.message});default:return e}},X={contracts:[]},Y=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:X,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"CREATE_CONTRACT":return console.log("Created contract",t.contract),e;case"CREATE_CONTRACT_ERROR":return console.log("create contract error: ",t.err),e;case"DELETE_CONTRACT":return console.log("Contract deleted!",t.contract),e;case"MODIFY_CONTRACT":return console.log("Contract modified!!",t.contract),console.log("Contenu Local: ====> ",t.state.contract.content),Object(D.a)({},e);default:return e}},K=a(78),$=Object(S.c)({auth:Z,contract:Y,firestore:K.firestoreReducer,firebase:y.firebaseReducer}),H=a(271),Q=a(116),ee=a.n(Q);a(535),a(540);ee.a.initializeApp({apiKey:"AIzaSyCM5G3331ZnSmZ8LGsZsayORxVypJXlXF4",authDomain:"sage-papel-suivi-de-contrats.firebaseapp.com",databaseURL:"https://sage-papel-suivi-de-contrats.firebaseio.com",projectId:"sage-papel-suivi-de-contrats",storageBucket:"sage-papel-suivi-de-contrats.appspot.com",messagingSenderId:"494365980569"}),ee.a.firestore().settings({});var te=ee.a,ae=Object(S.e)($,Object(S.d)(Object(S.a)(H.a.withExtraArgument({getFirebase:y.getFirebase,getFirestore:K.getFirestore})),Object(K.reduxFirestore)(te),Object(y.reactReduxFirebase)(te,{useFirestoreForProfile:!0,userProfile:"users",attachAuthIsReady:!0})));ae.firebaseAuthIsReady.then(function(){l.a.render(r.a.createElement(g.a,{store:ae},r.a.createElement(W,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})})}},[[272,2,1]]]);
//# sourceMappingURL=main.81abd686.chunk.js.map